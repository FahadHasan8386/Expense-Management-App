@page "/app/expenseCategory/edit-form/{ExpenseCategoryId:long}"


<PageTitle>Create Expense Category</PageTitle>

<div class="container mt-4">
	<div class="card shadow-lg border-0">
		<div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
			<h4 class="mb-0">
			@if (ExpenseCategoryId == 0)
				{
					<span><i class="bi bi-plus-circle"></i> Create Expense Category</span>
				}
				else
				{
				<span><i class="bi bi-pencil-square"></i> Edit Expense Category</span>
				}
			</h4>
			<a href="/app/expense-categories" class="btn btn-light btn-sm">
				<i class="bi bi-arrow-left"></i> Back to List
			</a>   
		</div>    

		<div class="card-body">  

			<div class="row mb-3">
				@if (ExpenseCategoryId > 0)
				{
					<div class="col-md-4">
						<label class="form-label fw-semibold">Expense Category Id</label>
						<InputNumber @bind-Value="ExpenseCategoriesDto.ExpenseCategoryId" class="form-control" readonly />
					</div>
				}

				<div class="col-md-4">
					<label class="form-label fw-semibold">Expense Category Name</label>
					<InputTextArea @bind-Value="ExpenseCategoriesDto.ExpenseCategoryName" class="form-control" rows="3" placeholder="Write Name..." />
				</div>

				<div class="col-md-12">
					<label class="form-label fw-semibold">Remarks</label>
					<InputTextArea @bind-Value="ExpenseCategoriesDto.Remarks" class="form-control" rows="3" placeholder="Write remarks..." />
				</div>

				<div class="col-md-12 text-end">
					<button class="@(ExpenseCategoryId > 0 ? "btn btn-warning" : "btn btn-success")" style="padding: 10px 20px;" @onclick="OnSubmitClickAsync">
						@((ExpenseCategoryId == 0) ? "Save" : "Update")
					</button>
				</div>
			</div>
		</div>
	</div>
</div>


@code{
	[Parameter]
	public long ExpenseCategoryId{ get; set; }
	private ExpenseCategoriesDto ExpenseCategoriesDto { get; set; } = new();
	private ExpenseCategoriesViewModel ExpenseCategoriesViewModel { get; set; } = new();

	protected async override Task OnInitializedAsync()
	{
		if (ExpenseCategoryId > 0)	
			await LoadExpenseCategoryAsync();
	}

	private async Task LoadExpenseCategoryAsync()
	{
		ExpenseCategoriesViewModel = await ExpenseCategoryApiService.GetExpenseCategoryByIdAsync(ExpenseCategoryId);
		ExpenseCategoriesDto.ExpenseCategoryId = ExpenseCategoriesViewModel.ExpenseCategoryId;
		ExpenseCategoriesDto.ExpenseCategoryName = ExpenseCategoriesViewModel.ExpenseCategoryName;
		ExpenseCategoriesDto.Remarks = ExpenseCategoriesViewModel.Remarks;
	}

	private async Task OnSubmitClickAsync()
	{
		if (ExpenseCategoryId == 0)
		{
			await ExpenseCategoryApiService.CreateExpenseCategoryAsync(ExpenseCategoriesDto);
		}
		else
		{
			await ExpenseCategoryApiService.UpdateExpenseCategoryAsync(ExpenseCategoriesDto);
		}

		NavigationManager.NavigateTo("/app/expense-categories");
	}
}   
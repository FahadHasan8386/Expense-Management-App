@page "/app/deposits/edit-form/{DepositId:long}"

<PageTitle>Deposit Create</PageTitle>

<DepositsComponente IsModal="false" DepositId="DepositId" DepositDto="new()"></DepositsComponente>

@code {
	[Parameter]
	public long DepositId { get; set; }
	private DepositDto DepositDto { get; set; } = new();
	private DepositViewModel DepositViewModel { get; set; } = new();

	protected async override Task OnInitializedAsync()
	{
		if (DepositId > 0)
			await LoadDipostisAsync();
	}

	private async Task LoadDipostisAsync()
	{
		DepositViewModel = await DepositApiService.GetDepositByIdAsync(DepositId);
		DepositDto.DepositId = DepositViewModel.DepositId;
		DepositDto.DepositDate = DepositViewModel.DepositDate;
		DepositDto.DepositAmount = DepositViewModel.DepositAmount;
		DepositDto.Remarks = DepositViewModel.Remarks;
	}

	private async Task OnFomSubmitClickAsync()
	{
		if (DepositId == 0)
		{
			await DepositApiService.AddDepositAsync(DepositDto);
		}
		else
		{
			await DepositApiService.UpdateDepositAsync(DepositDto);
		}

		NavigationManager.NavigateTo("/app/deposits");
	}
}
